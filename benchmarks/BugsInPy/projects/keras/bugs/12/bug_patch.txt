diff --git a/keras/metrics.py b/keras/metrics.py
index 8e3df1f365f8..b0c500b2c570 100644
--- a/keras/metrics.py
+++ b/keras/metrics.py
@@ -34,10 +34,13 @@ def categorical_accuracy(y_true, y_pred):
 
 
 def sparse_categorical_accuracy(y_true, y_pred):
-    # flatten y_true in case it's in shape (num_samples, 1) instead of (num_samples,)
-    return K.cast(K.equal(K.flatten(y_true),
-                          K.cast(K.argmax(y_pred, axis=-1), K.floatx())),
-                  K.floatx())
+    # reshape in case it's in shape (num_samples, 1) instead of (num_samples,)
+    if K.ndim(y_true) == K.ndim(y_pred):
+        y_true = K.squeeze(y_true, -1)
+    # convert dense predictions to labels
+    y_pred_labels = K.argmax(y_pred, axis=-1)
+    y_pred_labels = K.cast(y_pred_labels, K.floatx())
+    return K.cast(K.equal(y_true, y_pred_labels), K.floatx())
 
 
 def top_k_categorical_accuracy(y_true, y_pred, k=5):
